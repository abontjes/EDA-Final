---
title: "EDA Final"
author: "Andrew Bontjes"
date: "12/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# data cleaning and formatting

#import packages
library(dplyr)
library(stringr)
library(tidyr)
library(ggplot2)

# import data and remove unnecessary columns change date format
library(readr)
sd <- read_csv("spotify_dataset.csv", 
    col_types = cols(`Release Date` = col_date(format = "%Y-%m-%d"), 
        `Weeks Charted` = col_skip(),
        `Index` = col_skip()))
View(sd)

#get rid of spaces in columns with stringr package
names(sd)<-str_replace_all(names(sd), c(" " = "."))

#Get rid of values with empty values
sd <- na.omit(sd)

# Change Chord and Song.ID to factor data type
sd$Chord <- as.factor(sd$Chord)
str(sd$Chord)

sd$Song.ID <- as.factor(sd$Song.ID)

# Set Week of highest charting to usable date format
sd$Week.of.Highest.Charting <- sapply(strsplit(sd$Week.of.Highest.Charting, "--"), head, 1)
sd$Week.of.Highest.Charting <- as.Date(sd$Week.of.Highest.Charting, format = "%Y-%m-%d")

# Reformat genre column to one only first genre
sd$Genre <- gsub(",.*", "", sd$Genre)
sd$Genre <- gsub(",.*|\\].*", "", sd$Genre)
sd$Genre <- gsub(",.*|\\].*", "", sd$Genre)
sd$Genre <- gsub(",.*|\\].*|\\[", "", sd$Genre)

sd$Genre <- as.factor(sd$Genre)


#check the summary of the data
summary(sd)
str(sd$Genre)

```




```{r}
#investigate genre column

ggplot(sd, aes(Genre)) + geom_bar() + theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))

table(sd$Genre)

```













